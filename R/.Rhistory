HR1 <- c(0.6,0.8,0.9)
HR2 <- c(0.6,0.8,0.9)
P1 <- c(0.1,0.2,0.4)
P2 <- c(0.1,0.2,0.4)
CASE <- 1:4
COPULA <- 'Frank'
RHO_THYPE <- 'Spearman'
d_test <- expand.grid(RHO,
BETA1,
BETA2,
HR1,
HR2,
P1,
P2,
CASE,
COPULA,
RHO_THYPE)
dim(d_test)
d_test <- expand.grid(RHO,
BETA1,
BETA2,
HR1,
HR2,
P1,
P2,
CASE,
COPULA,
RHO_THYPE)
dim(d_test)
for(i in 1:nrow(d_test)){
print(i)
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
}
M_ERROR <- matrix(ncol=3,nrow=nrow(d_test))
for(i in 1:3){ # nrow(d_test)
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
test_ARE <- try(ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type),silent = TRUE)
test_effect <- try(effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type, plot_HR=FALSE),silent = TRUE)
test_SS <- try(samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=beta1, beta_e2=beta2,
case, copula = copula, rho=rho, rho_type=rho_type, alpha=0.05, power=0.80 ,ss_formula='schoendfeld'),silent = TRUE)
M[i,] <- class(test_ARE=="try-error")
cat('Iteration:',i,'/',nrow(d_test),'Errors:',sum(M,na.rm = TRUE),',\n')
}
for(i in 1:3){ # nrow(d_test)
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
test_ARE <- try(ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type),silent = TRUE)
test_effect <- try(effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type, plot_HR=FALSE),silent = TRUE)
test_SS <- try(samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=beta1, beta_e2=beta2,
case, copula = copula, rho=rho, rho_type=rho_type, alpha=0.05, power=0.80 ,ss_formula='schoendfeld'),silent = TRUE)
M_ERROR[i,] <- class(test_ARE=="try-error")
cat('Iteration:',i,'/',nrow(d_test),'Errors:',sum(M,na.rm = TRUE),',\n')
}
M_ERROR <- matrix(ncol=3,nrow=nrow(d_test))
for(i in 1:3){ # nrow(d_test)
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
test_ARE <- try(ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type),silent = TRUE)
test_effect <- try(effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type, plot_HR=FALSE),silent = TRUE)
test_SS <- try(samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=beta1, beta_e2=beta2,
case, copula = copula, rho=rho, rho_type=rho_type, alpha=0.05, power=0.80 ,ss_formula='schoendfeld'),silent = TRUE)
M_ERROR[i,1] <- class(test_ARE=="try-error")
M_ERROR[i,2] <- class(test_effect=="try-error")
M_ERROR[i,3] <- class(test_SS=="try-error")
cat('Iteration:',i,'/',nrow(d_test),'Errors:',sum(M_ERROR,na.rm = TRUE),',\n')
}
for(i in 1:3){ # nrow(d_test)
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
test_ARE <- try(ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type),silent = TRUE)
test_effect <- try(effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type, plot_HR=FALSE),silent = TRUE)
test_SS <- try(samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=beta1, beta_e2=beta2,
case, copula = copula, rho=rho, rho_type=rho_type, alpha=0.05, power=0.80 ,ss_formula='schoendfeld'),silent = TRUE)
M_ERROR[i,1] <- class(test_ARE)=="try-error"
M_ERROR[i,2] <- class(test_effect)=="try-error"
M_ERROR[i,3] <- class(test_SS)=="try-error"
cat('Iteration:',i,'/',nrow(d_test),'Errors:',sum(M_ERROR,na.rm = TRUE),',\n')
}
head(M_ERROR)
M_ERROR <- matrix(ncol=3,nrow=nrow(d_test))
for(i in 1:3){ # nrow(d_test)
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
test_ARE <- try(ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type),silent = TRUE)
test_effect <- try(effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type, plot_HR=FALSE),silent = TRUE)
test_SS <- try(samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=beta1, beta_e2=beta2,
case, copula = copula, rho=rho, rho_type=rho_type, alpha=0.05, power=0.80 ,ss_formula='schoendfeld'),silent = TRUE)
M_ERROR[i,1] <- class(test_ARE)=="try-error"
M_ERROR[i,2] <- class(test_effect)=="try-error"
M_ERROR[i,3] <- class(test_SS)=="try-error"
cat('Iteration:',i,'/',nrow(d_test),'Errors:',sum(M_ERROR=="TRUE",na.rm = TRUE),',\n')
}
head(M_ERROR)
ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type)
p1
d_test$P1
d_test
names(d_test)
d_test <- expand.grid(RHO=RHO,
BETA1=BETA1,
BETA2=BETA2,
HR1=HR1,
HR2=HR2,
P1=P1,
P2=P2,
CASE=CASE,
COPULA=COPULA,
RHO_THYPE=RHO_THYPE)
dim(d_test)
M_ERROR <- matrix(ncol=3,nrow=nrow(d_test))
for(i in 1:3){ # nrow(d_test)
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
test_ARE <- try(ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type),silent = TRUE)
test_effect <- try(effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type, plot_HR=FALSE),silent = TRUE)
test_SS <- try(samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=beta1, beta_e2=beta2,
case, copula = copula, rho=rho, rho_type=rho_type, alpha=0.05, power=0.80 ,ss_formula='schoendfeld'),silent = TRUE)
M_ERROR[i,1] <- class(test_ARE)=="try-error"
M_ERROR[i,2] <- class(test_effect)=="try-error"
M_ERROR[i,3] <- class(test_SS)=="try-error"
cat('Iteration:',i,'/',nrow(d_test),'Errors:',sum(M_ERROR=="TRUE",na.rm = TRUE),',\n')
}
head(M_ERROR)
i
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
rho_type
d_test
RHO <- c(0.1, 0.5, 0.7)
BETA1 <- c(0.5, 1, 2)
BETA2 <- c(0.5, 1, 2)
HR1 <- c(0.6,0.8,0.9)
HR2 <- c(0.6,0.8,0.9)
P1 <- c(0.1,0.2,0.4)
P2 <- c(0.1,0.2,0.4)
CASE <- 1:4
COPULA <- 'Frank'
RHO_THYPE <- 'Spearman'
d_test <- expand.grid(RHO=RHO,
BETA1=BETA1,
BETA2=BETA2,
HR1=HR1,
HR2=HR2,
P1=P1,
P2=P2,
CASE=CASE,
COPULA=COPULA,
RHO_THYPE=RHO_THYPE)
d_test
dim(d_test)
M_ERROR <- matrix(ncol=3,nrow=nrow(d_test))
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
test_ARE <- try(ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type),silent = TRUE)
sapply(d_test,class)
d_test <- expand.grid(RHO=RHO,
BETA1=BETA1,
BETA2=BETA2,
HR1=HR1,
HR2=HR2,
P1=P1,
P2=P2,
CASE=CASE,
COPULA=COPULA,
RHO_THYPE=RHO_THYPE,stringsAsFactors = FALSE)
dim(d_test)
M_ERROR <- matrix(ncol=3,nrow=nrow(d_test))
for(i in 1:3){ # nrow(d_test)
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
test_ARE <- try(ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type),silent = TRUE)
test_effect <- try(effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type, plot_HR=FALSE),silent = TRUE)
test_SS <- try(samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=beta1, beta_e2=beta2,
case, copula = copula, rho=rho, rho_type=rho_type, alpha=0.05, power=0.80 ,ss_formula='schoendfeld'),silent = TRUE)
M_ERROR[i,1] <- class(test_ARE)=="try-error"
M_ERROR[i,2] <- class(test_effect)=="try-error"
M_ERROR[i,3] <- class(test_SS)=="try-error"
cat('Iteration:',i,'/',nrow(d_test),'Errors:',sum(M_ERROR=="TRUE",na.rm = TRUE),',\n')
}
head(M_ERROR)
nrow(d_test)
3*3*3*4*4*3*3*4
3*3*3*3*3*3*3*4
RHO <- c(0.1, 0.5, 0.7)
BETA1 <- c(0.5, 1, 2)
BETA2 <- c(0.5, 1, 2)
HR1 <- c(0.6,0.8,0.9)
HR2 <- c(0.6,0.8,0.9)
P1 <- c(0.1,0.2,0.4)
P2 <- c(0.1,0.2,0.4)
CASE <- 1:4
COPULA <- 'Frank'
RHO_THYPE <- 'Spearman'
d_test <- expand.grid(RHO=RHO,
BETA1=BETA1,
BETA2=BETA2,
HR1=HR1,
HR2=HR2,
P1=P1,
P2=P2,
CASE=CASE,
COPULA=COPULA,
RHO_THYPE=RHO_THYPE,stringsAsFactors = FALSE)
dim(d_test)
M_ERROR <- matrix(ncol=3,nrow=nrow(d_test))
for(i in 1:3){ # nrow(d_test)
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
test_ARE <- try(ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type),silent = TRUE)
test_effect <- try(effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type, plot_HR=FALSE),silent = TRUE)
test_SS <- try(samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=beta1, beta_e2=beta2,
case, copula = copula, rho=rho, rho_type=rho_type, alpha=0.05, power=0.80 ,ss_formula='schoendfeld'),silent = TRUE)
M_ERROR[i,1] <- class(test_ARE)=="try-error"
M_ERROR[i,2] <- class(test_effect)=="try-error"
M_ERROR[i,3] <- class(test_SS)=="try-error"
cat('Iteration:',i,'/',nrow(d_test),'Errors:',sum(M_ERROR=="TRUE",na.rm = TRUE),'\n')
}
for(i in 1:3){ # nrow(d_test)
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
test_ARE <- try(suppressMessages(ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type)),silent = TRUE)
test_effect <- try(suppressMessages(effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type, plot_HR=FALSE)),silent = TRUE)
test_SS <- try(samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=beta1, beta_e2=beta2,
case, copula = copula, rho=rho, rho_type=rho_type, alpha=0.05, power=0.80 ,ss_formula='schoendfeld'),silent = TRUE)
M_ERROR[i,1] <- class(test_ARE)=="try-error"
M_ERROR[i,2] <- class(test_effect)=="try-error"
M_ERROR[i,3] <- class(test_SS)=="try-error"
cat('Iteration:',i,'/',nrow(d_test),'Errors:',sum(M_ERROR=="TRUE",na.rm = TRUE),'\n')
}
for(i in 1:3){ # nrow(d_test)
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
test_ARE <- try(suppressMessages(ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type)),silent = TRUE)
test_effect <- try(suppressMessages(effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type, plot_HR=FALSE)),silent = TRUE)
test_SS <- try(suppressMessages(samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=beta1, beta_e2=beta2,
case, copula = copula, rho=rho, rho_type=rho_type, alpha=0.05, power=0.80 ,ss_formula='schoendfeld')),silent = TRUE)
M_ERROR[i,1] <- class(test_ARE)=="try-error"
M_ERROR[i,2] <- class(test_effect)=="try-error"
M_ERROR[i,3] <- class(test_SS)=="try-error"
cat('Iteration:',i,'/',nrow(d_test),'Errors:',sum(M_ERROR=="TRUE",na.rm = TRUE),'\n')
}
rm(list=ls())
library(copula)
library(numDeriv)
library(rootSolve)
# library(eha)
library(ggplot2)
##-- Ruled out
# lambdaC10_ <- function(t) hweibull(t,beta1,b10)
##-- Parameters
rho=0.7
beta1=beta_e1=1
beta2=beta_e2=1
HR1=HR_e1=0.9
HR2=HR_e2=0.6
p1=p0_e1=0.2
p2=p0_e2=0.2
case = 3
copula='Frank'
rho_type='Spearman'
#########################
# ARE
#########################
##-- Old
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions.R')
# source('C:/Users/jcortes/Dropbox/Sample Size T2E/Simulations/functions_ARE.R')
#
# ARE(rho0=rho, beta1=beta1, beta2=beta2, HR1=HR1, HR2=HR2, p1=p1, p2=p2, case = case, copula = copula, rhoType=rho_type)
##-- New
setwd('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R')
list_files0 <- list.files()
list_files <- list_files0[grepl('\\.R',list_files0)]
for(f in list_files) source(f)
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/ARE_tte_array.R')
# source('C:/Users/jcortes/Google Drive/CompARE package/CompARE-package/CompARE-package/R/check_PROBT1UNC_int.R')
ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2, case = case, rho=rho, copula = copula, rho_type=rho_type)
# 3.39
# 3.96
# 4.49
#########################
# Effect size
#########################
# p0_e1=p1; p0_e2=p2; HR_e1=HR1; HR_e2=HR2; beta_e1=beta1; beta_e2=beta2; case = case; rho=rho; copula = copula; rho_type='Spearman'
effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type='Spearman', plot_HR=TRUE)
#########################
# Sample size
#########################
samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=1, beta_e2=1, case, copula = 'Frank', rho=0.3, rho_type='Spearman', alpha=0.05, power=0.80 ,ss_formula='schoendfeld')
#########################
# GRID
#########################
##-- Parameters
RHO <- c(0.1, 0.5, 0.7)
BETA1 <- c(0.5, 1, 2)
BETA2 <- c(0.5, 1, 2)
HR1 <- c(0.6,0.8,0.9)
HR2 <- c(0.6,0.8,0.9)
P1 <- c(0.1,0.2,0.4)
P2 <- c(0.1,0.2,0.4)
CASE <- 1:4
COPULA <- 'Frank'
RHO_THYPE <- 'Spearman'
d_test <- expand.grid(RHO=RHO,
BETA1=BETA1,
BETA2=BETA2,
HR1=HR1,
HR2=HR2,
P1=P1,
P2=P2,
CASE=CASE,
COPULA=COPULA,
RHO_THYPE=RHO_THYPE,stringsAsFactors = FALSE)
dim(d_test)
M_ERROR <- matrix(ncol=3,nrow=nrow(d_test))
for(i in 1:nrow(d_test)){ # nrow(d_test)
rho=d_test$RHO[i]
beta1=beta_e1=d_test$BETA1[i]
beta2=beta_e2=d_test$BETA2[i]
HR1=HR_e1=d_test$HR1[i]
HR2=HR_e2=d_test$HR2[i]
p1=p0_e1=d_test$P1[i]
p2=p0_e2=d_test$P2[i]
case = d_test$CASE[i]
copula=d_test$COPULA[i]
rho_type=d_test$RHO_THYPE[i]
test_ARE <- try(suppressMessages(ARE_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type)),silent = TRUE)
test_effect <- try(suppressMessages(effectsize_tte(p0_e1=p1, p0_e2=p2, HR_e1=HR1, HR_e2=HR2, beta_e1=beta1, beta_e2=beta2,
case = case, rho=rho, copula = copula, rho_type=rho_type, plot_HR=FALSE)),silent = TRUE)
test_SS <- try(suppressMessages(samplesize_tte(p0_e1, p0_e2, HR_e1, HR_e2, beta_e1=beta1, beta_e2=beta2,
case, copula = copula, rho=rho, rho_type=rho_type, alpha=0.05, power=0.80 ,ss_formula='schoendfeld')),silent = TRUE)
M_ERROR[i,1] <- class(test_ARE)=="try-error"
M_ERROR[i,2] <- class(test_effect)=="try-error"
M_ERROR[i,3] <- class(test_SS)=="try-error"
cat('Iteration:',i,'/',nrow(d_test),'Errors:',sum(M_ERROR=="TRUE",na.rm = TRUE),'\n')
}
head(M_ERROR)
save.image(file = 'test_results.RData')
test_SS
TEST_ERROR <- cbind(d_test,M_ERROR)
View(TEST_ERROR)
colnames(M_ERROR) <- c('error_ARE','erros_effect','error_SS')
TEST_ERROR <- cbind(d_test,M_ERROR)
save(TEST_ERROR,file = 'C:/Users/jcortes/Google Drive/CompARE package/test_results.RData')
1-0.9740
1-0898
1-0.898
lambda <- 1.5
qmax <- qpois(0.99,lambda)
qmax
qmax <- qpois(0.99,lambda)
plot(0:qmax,dpois(0:qmax,lambda),type='h')
par(las=1)
plot(0:qmax,dpois(0:qmax,lambda),type='h',xlab='Terminals',ylab='Probabilitat')
abline(h=seq(0,0.5,0.05),lty=2,col='grey')
lambda <- 1.5
qmax <- qpois(0.99,lambda)
par(las=1)
plot(0:qmax,dpois(0:qmax,lambda),type='h',xlab='Terminals',ylab='Probabilitat')
abline(h=seq(0,0.5,0.05),lty=2,col='grey')
log(0.22)
1/1.5
10*1.5
10*1.5*60
3*1.5*60
180*1.5
-20/sqrt(270)
40-16.45
40+1.645*5
40-1.645*5
48.23*50
48.23*500
40-1.645*5*500
(40+1.645*5)*500
(40-1.645*5)*500
qqnorm(percentage)
qqline(percentage)
percentage <- c(99.83,98.83,99.62,99.44,99.63,100,98.25,95.08,97.02,98.27,99.02)
qqnorm(percentage)
qqline(percentage)
boxplot(percentage)
9*0.01
